function Get-HBAWWN
{
    [CmdletBinding()]
    Param
    (
        # Param1 help description
        [Parameter(ValueFromPipelineByPropertyName=$true, Position=0)]
        [string[]]$Computername = $env:COMPUTERNAME
    )

    Begin
    {
    }
    Process
    {
        foreach ($Computer in $Computername) {
            $PortWNNParams = @{ 
                    Namespace    = 'root\WMI' 
                    class        = 'MSFC_FibrePortHBAAttributes' 
                    ComputerName = $Computer  
                    ErrorAction  = 'Stop' 
                    }
            try {
                Get-WmiObject @PortWNNParams | ForEach-Object {
                    $hash = @{
                        ComputerName     = $_.__SERVER;
                        PortWWN = ($_.Attributes.PortWWN | foreach {"{0:X}" -f $_}) -join ":";
                        NodeWWN = ($_.Attributes.NodeWWN | foreach {"{0:X}" -f $_}) -join ":";
                    }
                    New-Object -TypeName PSCustomObject -Property $hash
                }
            } catch {
                Write-Warning "$computer : $_"
            }
        }
    }
    End
    {
    }
}
